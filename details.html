<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Product Details</title>

<style>
:root{
  --brand:#2b7a78;
  --bg:#eef3f7;
  --card:#fff;
  --max-w:520px;
}
html,body{margin:0;height:100%;}
body{
  font-family:'Segoe UI',Roboto,Arial;
  background:var(--bg);
  padding:20px;
  display:flex;
  justify-content:center;
}
.card{
  width:100%;
  max-width:var(--max-w);
  background:var(--card);
  padding:22px;
  border-radius:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.12);
}
.success-banner{
  background:linear-gradient(135deg,#2ecc71,#27ae60);
  color:#fff;
  padding:14px;
  border-radius:10px;
  text-align:center;
  font-weight:600;
  margin-bottom:16px;
}
h2{margin:0 0 10px;color:#1d3557;}
h3{margin-top:20px;color:#264653;}
label{display:block;margin-top:12px;font-weight:600;}
input{
  width:100%;
  padding:11px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #c9d6df;
}
button{
  width:100%;
  padding:12px;
  margin-top:16px;
  background:var(--brand);
  color:#fff;
  border:none;
  border-radius:8px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
#status{margin-top:12px;font-weight:600}

/* Accordion */
.accordion{
  background:#fff;
  border-radius:12px;
  margin-top:14px;
  border-left:5px solid var(--brand);
  overflow:hidden;
}
.accordion-header{
  display:flex;
  justify-content:space-between;
  padding:14px;
  cursor:pointer;
}
.accordion-content{
  max-height:0;
  overflow:hidden;
  transition:max-height .3s ease;
  padding:0 14px;
}
.accordion.open .accordion-content{
  max-height:400px;
  padding:12px 14px 16px;
}
</style>
</head>

<body>
<main class="card">

  <div class="success-banner" id="banner">
    ðŸŽ‰ Congratulations! Your product is genuine and authenticated.
  </div>

  <h2>Product Authenticity Details</h2>
  <div id="info"></div>

  <!-- Warranty -->
  <div class="accordion">
    <div class="accordion-header" onclick="toggleAccordion(this)">
      <b>Warranty Information</b><span>â–¶</span>
    </div>
    <div class="accordion-content">
      <p><b>Type:</b> Manufacturer Limited Warranty</p>
      <p><b>Duration:</b> 12 Months</p>
      <p>Covers manufacturing defects only.</p>
    </div>
  </div>

  <!-- Care -->
  <div class="accordion">
    <div class="accordion-header" onclick="toggleAccordion(this)">
      <b>Care Instructions</b><span>â–¶</span>
    </div>
    <div class="accordion-content">
      <p>â€¢ Store in a cool, dry place</p>
      <p>â€¢ Avoid water & chemicals</p>
      <p>â€¢ Do not tamper or self-repair</p>
    </div>
  </div>

  <!-- Batch -->
  <div class="accordion">
    <div class="accordion-header" onclick="toggleAccordion(this)">
      <b>Factory Batch Information</b><span>â–¶</span>
    </div>
    <div class="accordion-content">
      <p><b>Quality Check:</b> 4-Step Inspection</p>
      <p><b>Batch Certified:</b> Yes</p>
    </div>
  </div>

  <!-- Packaging -->
  <div class="accordion">
    <div class="accordion-header" onclick="toggleAccordion(this)">
      <b>Packaging Authenticity</b><span>â–¶</span>
    </div>
    <div class="accordion-content">
      <p>âœ” Tamper-proof seal</p>
      <p>âœ” Encrypted QR token</p>
      <p>âœ” Real-time verification</p>
    </div>
  </div>

  <!-- Manufacturer -->
  <div class="accordion">
    <div class="accordion-header" onclick="toggleAccordion(this)">
      <b>Manufacturer Details</b><span>â–¶</span>
    </div>
    <div class="accordion-content">
      <p><b>Company:</b> Track and Create Pvt. Ltd.</p>
      <p><b>HQ:</b> Delhi, India</p>
      <p><b>Plant:</b> Ghaziabad (ISO Certified)</p>
    </div>
  </div>

  <h3>Claim Your Prize</h3>

  <label>Name</label>
  <input id="custName" placeholder="Full name">

  <label>Phone Number</label>
  <input id="custPhone" maxlength="10" placeholder="10-digit number"
    oninput="this.value=this.value.replace(/\\D/g,'')">

  <button onclick="saveCustomer()">Save Details</button>
  <div id="status"></div>

</main>

<script>
const params = new URLSearchParams(location.search);
const enc = params.get("enc");

if(!enc){
  document.getElementById("banner").textContent="Invalid access";
}

function toggleAccordion(el){
  const acc = el.parentElement;
  document.querySelectorAll(".accordion").forEach(a=>{
    if(a!==acc) a.classList.remove("open");
  });
  acc.classList.toggle("open");
}

async function saveCustomer(){
  const name = custName.value.trim();
  const phone = custPhone.value.trim();
  const status = document.getElementById("status");

  if(!name || phone.length!==10){
    status.style.color="red";
    status.textContent="Enter valid details";
    return;
  }

  try{
    await fetch("https://asia-south1-track-and-trace-native.cloudfunctions.net/saveCustomer",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({enc,name,phone})
    });

    window.location.href="thankyou.html";
  }catch(e){
    status.style.color="red";
    status.textContent="Failed. Try again.";
  }
}
</script>

</body>
</html>
