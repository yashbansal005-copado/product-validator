<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Scratch Card Popup</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #eef7ff;
    margin: 0;
    padding: 0;
  }

  /* Overlay */
  #popupOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.55);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 999;
  }

  /* Popup Box */
  #popupBox {
    background: white;
    width: 90%;
    max-width: 380px;
    padding: 20px;
    border-radius: 14px;
    text-align: center;
    box-shadow: 0 0 25px rgba(0,0,0,0.2);
    animation: fadeIn 0.4s ease;
  }

  @keyframes fadeIn {
    from { transform: scale(0.8); opacity: 0; }
    to   { transform: scale(1); opacity: 1; }
  }

  /* Scratch container */
  #scratchContainer {
    position: relative;
    width: 100%;
    margin-top: 10px;
    display: flex;
    justify-content: center;
  }

  /* Prize Text (behind canvas) */
  #prizeText {
    position: absolute;
    z-index: 1;
    font-size: 28px;
    font-weight: bold;
    color: #2ecc71;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
  }

  /* Canvas (scratch surface) */
  #scratchCanvas {
    width: 260px;
    height: 160px;
    background: #c0c0c0;
    border-radius: 12px;
    z-index: 2;
    display: block;
  }

  /* Close button */
  #closeBtn {
    margin-top: 18px;
    padding: 10px 18px;
    background: #1b6ca8;
    color: white;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-size: 16px;
  }

  #closeBtn:hover { background: #155986; }
</style>
</head>

<body>

<!-- SCRATCH POPUP -->
<div id="popupOverlay">
  <div id="popupBox">

    <h2>Scratch & Win!</h2>

    <div id="scratchContainer">
      <div id="prizeText"></div>
      <canvas id="scratchCanvas"></canvas>
    </div>

    <button id="closeBtn">Close</button>

  </div>
</div>


<script>
/* ------------ RANDOM PRIZES --------------- */
const prizes = ["₹10", "₹20", "₹50", "₹100", "₹200", "₹500", "Better luck next time!"];
const selectedPrize = prizes[Math.floor(Math.random() * prizes.length)];
document.getElementById("prizeText").innerText = selectedPrize;

/* ------------ SCRATCH CARD LOGIC ------------ */
const canvas = document.getElementById("scratchCanvas");
const ctx = canvas.getContext("2d");
let isDrawing = false;

function resizeCanvas() {
  canvas.width = canvas.offsetWidth;
  canvas.height = canvas.offsetHeight;

  // Fill scratch color
  ctx.fillStyle = "#bbbbbb";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Add small noise pattern
  for (let i = 0; i < 2000; i++) {
    ctx.fillStyle = "rgba(255,255,255,0.15)";
    ctx.fillRect(
      Math.random() * canvas.width,
      Math.random() * canvas.height,
      2, 2
    );
  }
}

resizeCanvas();

/* Set composite mode so scratch becomes transparent */
ctx.globalCompositeOperation = "destination-out";

/* Pointer events */
canvas.addEventListener("pointerdown", e => {
  isDrawing = true;
  scratch(e);
});

canvas.addEventListener("pointermove", e => {
  if (isDrawing) scratch(e);
});

canvas.addEventListener("pointerup", () => {
  isDrawing = false;
});

canvas.addEventListener("pointerleave", () => {
  isDrawing = false;
});

/* Scratch function */
function scratch(e) {
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  ctx.beginPath();
  ctx.arc(x, y, 18, 0, Math.PI * 2);
  ctx.fill();
}

/* Close button */
document.getElementById("closeBtn").onclick = () => {
  document.getElementById("popupOverlay").style.display = "none";
};
</script>

</body>
</html>
